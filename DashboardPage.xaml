<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="JournalApp.DashboardPage"
             Title="Dashboard"
             BackgroundColor="#f8fafc">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="16">
            <!-- Stats Grid -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="12" RowSpacing="12">
                <Frame Padding="12" CornerRadius="12" HasShadow="True" BackgroundColor="#6366f1">
                    <VerticalStackLayout>
                        <Label Text="Total Entries" FontSize="12" TextColor="White" FontAttributes="Bold" />
                        <Label x:Name="TotalEntriesLabel" Text="0" FontSize="24" TextColor="White" FontAttributes="Bold" />
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="12" Grid.Column="1" CornerRadius="12" HasShadow="True" BackgroundColor="#06b6d4">
                    <VerticalStackLayout>
                        <Label Text="Current Streak" FontSize="12" TextColor="White" FontAttributes="Bold" />
                        <Label x:Name="CurrentStreakLabel" Text="0 days" FontSize="24" TextColor="White" FontAttributes="Bold" />
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="12" Grid.Row="1" CornerRadius="12" HasShadow="True" BackgroundColor="#6366f1">
                    <VerticalStackLayout>
                        <Label Text="Longest Streak" FontSize="12" TextColor="White" FontAttributes="Bold" />
                        <Label x:Name="LongestStreakLabel" Text="0 days" FontSize="24" TextColor="White" FontAttributes="Bold" />
                    </VerticalStackLayout>
                </Frame>

                <Frame Padding="12" Grid.Row="1" Grid.Column="1" CornerRadius="12" HasShadow="True" BackgroundColor="#06b6d4">
                    <VerticalStackLayout>
                        <Label Text="Avg Words" FontSize="12" TextColor="White" FontAttributes="Bold" />
                        <Label x:Name="AverageWordsLabel" Text="0" FontSize="24" TextColor="White" FontAttributes="Bold" />
                    </VerticalStackLayout>
                </Frame>
            </Grid>

            <!-- Mood Distribution -->
            <Label Text="Mood Distribution" FontSize="16" FontAttributes="Bold" Margin="0,10,0,0" TextColor="#0f172a" />
            <Frame Padding="12" CornerRadius="12" HasShadow="True" BackgroundColor="White">
                <VerticalStackLayout Spacing="8">
                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="8">
                        <Label Text="Positive" FontAttributes="Bold" VerticalOptions="Center" TextColor="#0f172a" />
                        <ProgressBar Grid.Column="1" x:Name="PositiveProgressBar" Progress="0" ProgressColor="#06b6d4" />
                        <StackLayout Grid.Column="2" Orientation="Horizontal" Spacing="2" HorizontalOptions="End">
                            <Label x:Name="PositivePercentLabel" Text="0%" FontAttributes="Bold" FontSize="12" VerticalOptions="Center" TextColor="#0f172a" />
                            <Label x:Name="PositiveCountLabel" Text="(0)" FontSize="11" VerticalOptions="Center" TextColor="#6b7280" />
                        </StackLayout>
                    </Grid>

                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="8">
                        <Label Text="Neutral" FontAttributes="Bold" VerticalOptions="Center" TextColor="#0f172a" />
                        <ProgressBar Grid.Column="1" x:Name="NeutralProgressBar" Progress="0" ProgressColor="#6366f1" />
                        <StackLayout Grid.Column="2" Orientation="Horizontal" Spacing="2" HorizontalOptions="End">
                            <Label x:Name="NeutralPercentLabel" Text="0%" FontAttributes="Bold" FontSize="12" VerticalOptions="Center" TextColor="#0f172a" />
                            <Label x:Name="NeutralCountLabel" Text="(0)" FontSize="11" VerticalOptions="Center" TextColor="#6b7280" />
                        </StackLayout>
                    </Grid>

                    <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="8">
                        <Label Text="Negative" FontAttributes="Bold" VerticalOptions="Center" TextColor="#0f172a" />
                        <ProgressBar Grid.Column="1" x:Name="NegativeProgressBar" Progress="0" ProgressColor="#f97316" />
                        <StackLayout Grid.Column="2" Orientation="Horizontal" Spacing="2" HorizontalOptions="End">
                            <Label x:Name="NegativePercentLabel" Text="0%" FontAttributes="Bold" FontSize="12" VerticalOptions="Center" TextColor="#0f172a" />
                            <Label x:Name="NegativeCountLabel" Text="(0)" FontSize="11" VerticalOptions="Center" TextColor="#6b7280" />
                        </StackLayout>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Missed Days -->
            <Label x:Name="MissedDaysLabel" Text="Missed Days: 0" FontSize="12" TextColor="#475569" />

            <!-- Recent Entries -->
            <Label Text="Recent Entries" FontSize="16" FontAttributes="Bold" Margin="0,10,0,0" TextColor="#0f172a" />
            <CollectionView x:Name="RecentEntriesCollectionView" 
                            HeightRequest="150"
                            SelectionMode="Single"
                            SelectionChanged="OnEntrySelected">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Padding="8" Margin="0,4" CornerRadius="8" HasShadow="True" BackgroundColor="White">
                            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="8">
                                <Label Text="{Binding EntryDate, StringFormat='{}{0:MMM dd}'}" FontAttributes="Bold" FontSize="12" TextColor="#6366f1" />
                                <Label Grid.Column="1" Text="{Binding Title}" LineBreakMode="TailTruncation" FontSize="12" TextColor="#0f172a" />
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
